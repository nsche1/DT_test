$(document).ready(function(){WELightBox1.Initialize()});var WELightBox1={Initialize:function(){var t,n;if(WEInfoPage.RenderMode=="Editor")return!1;for(IDElem in OEConfWELightBox1)t=$("#"+IDElem),t.css("z-index","2000000"),t.append('<div class="OESZ_MaskLightBox"><\/div>'),n=$("#"+IDElem+" .OESZ_ContentLightBox"),n.append("<div class='OESZ_LeaveLightBox OELightBox_Buttons'><\/div>"),n.append("<div class='OESZ_GoLeftLightBox OELightBox_Buttons' ><\/div>"),n.append("<img />"),n.append("<div class='OESZ_GoRightLightBox OELightBox_Buttons'><\/div>"),$OESZ_GoLeftLightBox=n.find(".OESZ_GoLeftLightBox"),$OESZ_GoRightLightBox=n.find(".OESZ_GoRightLightBox"),$OESZ_LeaveLightBox=n.find(".OESZ_LeaveLightBox"),n.data("OESZ_GoLeftLightBoxSize",{width:$OESZ_GoLeftLightBox.outerWidth(),height:$OESZ_GoLeftLightBox.outerHeight()}),n.data("OESZ_GoRightLightBoxSize",{width:$OESZ_GoRightLightBox.outerWidth(),height:$OESZ_GoRightLightBox.outerHeight()}),n.data("OESZ_LeaveLightBoxSize",{width:$OESZ_LeaveLightBox.outerWidth(),height:$OESZ_LeaveLightBox.outerHeight()}),t.find(".OESZ_DivContent").css("z-index","2000000"),WELightBox1.Init(OEConfWELightBox1[IDElem].ConfigLightBox1,IDElem)},Init:function(n,t){for(var u,r,i=n.length-1;i>=0;i--)u=n[i].IDElement.List[0],r=$("#"+u),r.css("cursor","pointer"),r.unbind("click"),r.bind("click",{msg:i},function(i){return WELightBox1.showPic(n,i.data.msg,t),!1})},updatePic:function(n,t,i){function nt(){p&&(u.unbind("load.updatePic"),u.bind("load.updatePic",function(){u.attr("data-img-loaded","1")}),u.attr("src","").attr("src",h).fadeTo(200,.25));r.animate(g,500,function(){return u.unbind("load.updatePic"),u.bind("load.updatePic",function(){if(u.attr("data-img-loaded","0"),u.stop().fadeTo("slow",1),u.data("infoExist")){var n=r.children(".OESZ_TitleLightBox").first().height()+r.children(".OESZ_OverviewLightBox").first().height()+r.children(".OESZ_LinkLightBox").first().height();n===0&&r.data("needUpdateHeight","1");newLightBoxHeight=r.height()+n;r.animate({height:newLightBoxHeight+"px"},100,function(){if(r.children(".OESZ_TitleLightBox").first().css("visibility","visible"),r.children(".OESZ_OverviewLightBox").first().css("visibility","visible"),r.children(".OESZ_LinkLightBox").first().css("visibility","visible"),r.data("needUpdateHeight")){var n=r.children(".OESZ_TitleLightBox").first().height()+r.children(".OESZ_OverviewLightBox").first().height()+r.children(".OESZ_LinkLightBox").first().height();r.css("height",parseInt(r.height())+n+"px");r.data("needUpdateHeight","")}return!1})}return!1}),p||s||u.attr("src","").attr("src",h).fadeTo(200,.25),n.length>1?r.find(".OELightBox_Buttons").fadeTo("fast",1):r.find(".OESZ_LeaveLightBox").fadeTo("fast",1),(s||u.attr("data-img-loaded")=="1")&&u.trigger("load.updatePic"),!1})}var r=$("#"+i+" .OESZ_ContentLightBox"),h=escape(OE.Common.Link.getPath(n[t].ZoomLink)),c=n[t].ZoomWidth,l=n[t].ZoomHeight,tt=n.length,a=100,v=100,y,w=$(window).height(),b=w-200,k=$(window).width()-r.data("OESZ_GoLeftLightBoxSize").width-r.data("OESZ_GoRightLightBoxSize").width-r.data("OESZ_LeaveLightBoxSize").width,f,o,u,d,g,e,s,p;c>=k&&(a=k/c*100);l>=b&&(v=b/l*100);y=a<v?a:v;f=Math.floor(c*y/100);o=Math.floor(l*y/100);newWidthImg=f;f=f+r.data("OESZ_GoLeftLightBoxSize").width+r.data("OESZ_GoRightLightBoxSize").width;LightBoxMarginTop=$(window).scrollTop()+(w-o)/2+-40;LightBoxMarginLeft=($(".OESZ_XBodyContent").width()-f)/2;u=r.children("img").first();d=WELightBox1.addInfoImage(r,n,t,i);u.data("infoExist",d);g={"margin-top":LightBoxMarginTop+"px","margin-left":LightBoxMarginLeft+"px",width:newWidthImg+"px",height:o+"px"};e=!u.attr("src");r.find(".OELightBox_Buttons").fadeTo(e?0:"fast",0);s=u.attr("src")==h&&!e;p=e&&!s;u.fadeTo(e?0:500,0,function(){$(this).css({width:newWidthImg+"px",height:o+"px"});nt()})},addInfoImage:function(n,t,i){var f=OE.Common.getLocString(t[i].Title),o=OE.Common.getLocString(t[i].Overview),r=OE.Common.Link.getPath(t[i].URL),s,h,e,u;return(n.children(".OESZ_TitleLightBox").remove(),n.children(".OESZ_OverviewLightBox").remove(),n.children(".OESZ_LinkLightBox").remove(),f==""&&o==""&&r=="")?!1:(f&&(r?(e=t[i].URL.Target,u=$("<div class='OESZ_TitleLightBox'><a "+OE.Common.Link.getHref(r,e)+" style='display :block ' class='OESZ_LinkLightBox'>"+f+"<\/a><\/div>"),n.append(u),u.bind("click",function(n){return OE.Navigate.popup(n,r)})):(s=$("<div class='OESZ_TitleLightBox'>"+f+"<\/div>"),s.css("visibility","hidden"),n.append(s))),o&&(h=$("<div class='OESZ_OverviewLightBox'>"+o+"<\/div>"),h.css("visibility","hidden"),n.append(h)),f||r&&(e=t[i].URL.Target,u=$("<div class='OESZ_LinkLightBox'><a "+OE.Common.Link.getHref(r,e)+" style='display :block '>"+r+"<\/a><\/div>"),u.css("visibility","hidden"),n.append(u),u.bind("click",function(n){return OE.Navigate.popup(n,r)})),!0)},showPic:function(n,t,i){var e=n.length,f=$("#"+i+" .OESZ_ContentLightBox"),o=f.children("img").first(),s=f.find(".OESZ_LeaveLightBox"),r,u;s.add(o).bind("click",function(){return $("#"+i+" .OESZ_MaskLightBox").fadeOut(),$("#"+i+" .OESZ_ContentLightBox").fadeOut(),!1});WELightBox1.updatePic(n,t,i);r=$(".OESZ_GoLeftLightBox");u=$(".OESZ_GoRightLightBox");e>1?(f.bind("mouseover.CssEvents",function(){r.show();u.show()}),f.bind("mouseleave.CssEvents",function(){r.hide();u.hide()}),r.unbind(".showPic"),r.bind("click.showPic",function(){return t=t>0?t-1:e-1,WELightBox1.updatePic(n,t,i),!1}),u.unbind(".showPic"),u.bind("click.showPic",function(){return t=t<e-1?parseInt(t)+1:0,WELightBox1.updatePic(n,t,i),!1})):(u.hide(),r.hide());f.fadeIn();$("#"+i+" .OESZ_MaskLightBox").css({filter:"alpha(opacity=80)"}).fadeIn("slow")}}